[Перелік усіх робіт](README.md)

# Лабораторна робота №7. Робота з файлами та збереження даних


## Мета роботи

Ознайомитися з методами читання та запису даних у файл

## Обладнання

Персональний комп'ютер. Пакет програм XAMPP. Текстовий редактор Sublime Text 3 або IDE NetBeans. Web-браузер Chrome, Firefox, Opera

## Хід роботи
1. Впевнитись, що пакет XAMPP встановлено та web-сервер Apache запущений
2. Перейти до каталогу `C:\xampp\htdocs\` та очистити його
3. Створити текстовий файл file.txt і записати до нього довільний текст у 4 рядка
4. Створити файл files.php та записати у нього наступний код:

```php
<?php
$file = fopen(__DIR__ . '/file.txt', 'r');
for ($i = 0; $i < 4; $i++) {
    echo fgets($file);
    echo '<br>';
}
fclose($file);	
```

5. Зберегти файл та переконатися, що на екрані з'явився ваш текст
6. Для читання не дуже зручно використовувати цикл for із зазначенням конкретного числа рядків, які необхідно зчитати. Для цього можна використовувати функцію feof() - вона повертає true, якщо досягнуто кінець файлу. Програма, переписана з використанням функції feof() буде виглядати наступним чином:

```php
<?php
$file = fopen(__DIR__ . '/file.txt', 'r');
while (!feof($file)) {
    echo fgets($file);
    echo '<br>';
}
fclose($file);
```

7. Тепер запишемо дані в файл. Для того щоб відкрити файл для запису використовується та ж функція fopen, тільки в якості режиму роботи вказується 'w' (від write). А для запису даних в файл в рядок використовується функція fputs(). Напишемо програму, яка запише в файл file2.txt числа від 1 до 100. 

```php
<?php
$file = fopen(__DIR__ . '/file2.txt', 'w');
for ($i = 1; $i < 101; $i++) {
    fputs($file, $i . PHP_EOL);
}
fclose($file);
```

**Примітка**. Константа PHP_EOL містить в собі символ розриву рядків. При цьому для різних операційних систем (Windows або Unix-подібних) ці символи будуть різними.

8. Для перевірки існування файлу використовується функція `file_exists()`

```php

<?php
myfile("counter.txt"); // Використовуєм функцію myfile, передаючи у якості аргументу ім'я файлу

function myfile($name) //Створюємо функцію для перевірки інування файлу
{
if (file_exists($name)) echo 'Файл існує';
else echo "Файл не існує";
}
?>
```

9. Для визначення розміру файлу потрібно скористатися функцією `filesize()`: 

```php
<?php
myfile("counter.txt");

function myfile($name)
{
if (file_exists($name)) echo "Розмір файлу: ".filesize($name).' байт';
else echo "Файл не існує";
}
?>
```

10. Видалити певний рядок з файлу можна за допомогою такого коду: 

```php

<?php
$num_stroka = 5; //Видалимо 5 рядок з файлу
$file = file("counter.txt"); // Зчитуємо весь файл в масив

for($i = 0; $i < sizeof($file); $i++)
if($i == $num_stroka) unset($file[$i]);

$fp = fopen("counter.txt", "w");
fputs($fp, implode("", $file));
fclose($fp);
?>
```

11. Створіть сценарій з наступними функціями:
    + сценарій виводить форму з полем багаторядкового вводу та дописує інформацію в кінець текстового файлу file.txt
    + використовуючи функцію `file_get_contents()`, сценарій виводить зміст файла користувачу
    + прочитайте файл порядково, та кожен рядок загорніть в тег `<p>` та виведіть весь зміст у відформатованому вигляді
12. Створіть сценарій з наступними функціями:
    - сценарій виводить користувачеві форму вводу із можливістю завантаження текстових файлів
    - текстові файли, які були завантажені зберігаються у директорії `texts`
    - у я кості параметру сценарію можна передати ім'я збереженого файлу і сценарій повинен вивести зміст файлу  
13. Впевнитись, що всі вихідні HTML-сторінки є валідними, використавши валідатор HTML-коду [validator.w3.org](https://validator.w3.org/). За необхідності, виправити помилки та зауваження
14. Для кожного етапу роботи зробити знімки екрану та додати їх у звіт з описом кожного скіншота
15. Додати програмний код завдання для самомтійного виконання
16. Дати відповіді на контрольні запитання
17. Зберегти звіт у форматі PDF

## Контрольні питання
1. На які етапи поділяється робота з файлами?
2. Які існують режими відкриття файлу?
3. Для чого використовується функція `fgets()`?
4. Якою функцією можна видалити рядки з файлу?
5. Як зберегти завантажений на сервер файл?
6. Як прочитати текстовий файл в масив рядків?

## Приклади

1. [Читання файлу](src/lab-07/read_1.php)
2. [Запис у файл](src/lab-07/write_1.php)

## Довідники та додаткові матеріали

1. [PHP File Handling](https://www.w3schools.com/php/php_file.asp)
2. [PHP Manual. Handling file uploads](https://www.php.net/manual/en/features.file-upload.php)
3. [PHP Manual. Directory Functions](https://www.php.net/manual/en/ref.dir.php)
4. [PHP Обробка файлів](https://w3schoolsua.github.io/php/php_file.html#gsc.tab=0)
5. [PHP Обробка форми](https://w3schoolsua.github.io/php/php_forms.html#gsc.tab=0)
6. [PHP Відкрити/Читати/Закрити файл](https://w3schoolsua.github.io/php/php_file_open.html#gsc.tab=0)